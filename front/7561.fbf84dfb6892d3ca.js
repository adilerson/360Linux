"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7561],{7561:(E,v,r)=>{r.r(v),r.d(v,{ConfigPageModule:()=>T});var u=r(9808),l=r(4182),s=r(5056),g=r(8808),c=r(655),f=r(9426),t=r(9863),p=r(1188),C=r(8819),_=r(6858);function x(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"ion-item",8),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(),d=n.$implicit,m=n.index,h=t.oxw();return t.KtG(h.eventoActionSheet(d,m))}),t.TgZ(2,"ion-label")(3,"h2"),t._uU(4),t.qZA(),t.TgZ(5,"p"),t._uU(6),t.ALo(7,"date"),t.qZA()()()()}if(2&i){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(e.nome),t.xp6(2),t.Oqu(t.xi3(7,2,e.data,"dd/MM/YYYY"))}}function b(i,a){if(1&i&&(t.ynx(0,6),t.YNc(1,x,8,5,"div",7),t.BQk()),2&i){const e=a.$implicit;t.xp6(1),t.Q6J("ngIf","null"!==e.nome)}}function y(i,a){if(1&i&&(t.TgZ(0,"ion-select-option",17),t._uU(1),t.qZA()),2&i){const e=a.$implicit,o=a.index;t.Q6J("value",e),t.xp6(1),t.hij("",e.label?e.label:"Default Video "+o," ")}}function P(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",9)(3,"ion-button",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.cancel())}),t._uU(4,"Cancelar"),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6,"Evento"),t.qZA(),t.TgZ(7,"ion-buttons",11)(8,"ion-button",12),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.salvaEvento(n.configForm.value))}),t._uU(9,"Salvar"),t.qZA()()()(),t.TgZ(10,"ion-content",13)(11,"h1",13),t._uU(12,"Configura\xe7\xe3o da entrada de Video"),t.qZA(),t.TgZ(13,"form",14)(14,"ion-item")(15,"ion-label"),t._uU(16,"Entrada de Video"),t.qZA(),t.TgZ(17,"ion-select",15),t.YNc(18,y,2,2,"ion-select-option",16),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(8),t.Q6J("strong",!0)("disabled",!e.configForm.valid),t.xp6(5),t.Q6J("formGroup",e.configForm),t.xp6(5),t.Q6J("ngForOf",e.videoDevices)}}const U=[{path:"",component:(()=>{class i{constructor(e,o,n,d,m,h,D,I){this.storage=e,this.formBuilder=o,this.actionSheetCtrl=n,this.alertController=d,this.eventoService=m,this.toastController=h,this.router=D,this.http=I,this.message="This modal example uses triggers to automatically open a modal when the button is clicked.",this.isSubmitted=!1,this.eventos=[],this.apiUrl="",this.videoDevices=[]}ngOnInit(){this.configForm=this.formBuilder.group({videoInput:["",l.kI.required]}),this.videoInput=this.storage.get("videoInput")||"",this.apiUrl=this.storage.get("apiUrl")||"",console.log(this.apiUrl),console.log(this.http.url),this.apiUrl.length&&f.P.get("apiUrl").emit(this.apiUrl),this.getEventos()}ionViewDidEnter(){console.log(this.getDevices())}get errorControl(){return this.configForm.controls}getEventos(){return(0,c.mG)(this,void 0,void 0,function*(){(yield this.http.getEventos()).subscribe(e=>{console.log(e),this.eventos=[];for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&this.eventos.push(e[o]);console.log(this.eventos)})})}cancel(){this.modal.dismiss(null,"cancel")}confirm(){this.modal.dismiss(this.name,"confirm")}onWillDismiss(e){"confirm"===e.detail.role&&(this.message=`Hello, ${e.detail.data}!`)}salvaEvento(e){return(0,c.mG)(this,void 0,void 0,function*(){this.guardaEventos(e.videoInput),console.log(e),this.configForm.reset(),this.modal.dismiss()})}eventoActionSheet(e,o){return(0,c.mG)(this,void 0,void 0,function*(){console.log(e);const n=yield this.actionSheetCtrl.create({header:"Op\xe7\xf5es do Evento",mode:"ios",subHeader:e.nome,buttons:[{text:"Carregar Evento",handler:()=>{this.setConfig(e)}},{text:"Visualizar Evento",handler:()=>{this.seeEvento(e)}},{text:"Cancelar",role:"cancel",data:{action:"cancel"}}]});yield n.present();const d=yield n.onDidDismiss();this.result=JSON.stringify(d,null,2)})}deleteEvento(e){return(0,c.mG)(this,void 0,void 0,function*(){const o=yield this.alertController.create({header:"Deseja realmente Deletar o evento?",buttons:[{text:"Cancelar",role:"cancel",handler:()=>{}},{text:"Sim",role:"confirm",handler:()=>{this.eventos.splice(e,1)}}]});yield o.present(),yield o.onDidDismiss()})}guardaEventos(e){return(0,c.mG)(this,void 0,void 0,function*(){this.storage.set("videoInput",e),setTimeout(()=>{this.videoInput=this.storage.get("videoInput")||""},100)})}setConfig(e){return(0,c.mG)(this,void 0,void 0,function*(){if(!e.videoInput&&this.videoInput&&(e.videoInput=this.videoInput),!e.videoInput&&!this.videoInput)return yield(yield this.toastController.create({message:"Selecione a camera que ir\xe1 utilizar primeiro",duration:3e3,position:"bottom",color:"danger"})).present(),void this.modal.present();this.eventoService.setConfig(e),this.router.navigate(["/home"])})}seeEvento(e){return(0,c.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:`Nome:${e.nome},  Grava\xe7\xe3o: ${e.tempo} seg`,subHeader:`${e.frameName?"Frame: "+e.frameName:""} ${e.audioName?", Audio: "+e.audioName:""}  ${this.videoInput?", "+this.videoInput.label:", N\xe3o informada"}`,buttons:[{text:"Fechar",role:"cancel",handler:()=>{}}]})).present()})}configUrltAlert(){return(0,c.mG)(this,void 0,void 0,function*(){const e=yield this.alertController.create({header:"Digite a url do servidor",subHeader:"ex: http://localhost:3000",buttons:["OK"],inputs:[{placeholder:"URL",value:`${this.apiUrl?this.apiUrl:""}`,handler:o=>{console.log(o)}}]});yield e.present(),e.onWillDismiss().then(o=>{var n;null!==(n=o.data)&&void 0!==n&&n.values[0]&&(this.apiUrl=o.data.values[0],this.storage.set("apiUrl",o.data.values[0]),f.P.get("apiUrl").emit(o.data.values[0]))})})}getDevices(){this.videoDevices=[],navigator.mediaDevices.getUserMedia({video:{width:{ideal:1080},height:{ideal:720}}}).then(e=>{navigator.mediaDevices.enumerateDevices().then(o=>{o.forEach(n=>{console.log(n),"videoinput"===n.kind&&n.deviceId&&this.videoDevices.push(n)})}),setTimeout(()=>{e.getTracks().forEach(o=>{o.stop()})},200)})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(p.V),t.Y36(l.qu),t.Y36(s.BX),t.Y36(s.Br),t.Y36(C.k),t.Y36(s.yF),t.Y36(g.F0),t.Y36(_.O))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-config"]],viewQuery:function(e,o){if(1&e&&(t.Gf(s.ki,5),t.Gf(s.x4,5)),2&e){let n;t.iGM(n=t.CRH())&&(o.modal=n.first),t.iGM(n=t.CRH())&&(o.dateTime=n.first)}},decls:14,vars:1,consts:[[1,"bg"],["slot","fixed","vertical","bottom","horizontal","end"],["id","open-modal",2,"width","130px !important"],["name","cog"],["style","font-size:2rem","class","bg",4,"ngFor","ngForOf"],["trigger","open-modal",3,"willDismiss"],[1,"bg",2,"font-size","2rem"],[4,"ngIf"],["button","",3,"click"],["slot","start"],[3,"click"],["slot","end"],[3,"strong","disabled","click"],[1,"ion-padding"],[3,"formGroup"],["placeholder","Video","id","Video","formControlName","videoInput","required",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar",0)(2,"ion-title",0),t._uU(3,"Lista de Eventos "),t.qZA()()(),t.TgZ(4,"ion-content",0)(5,"ion-fab",1)(6,"ion-fab-button",2),t._uU(7,"Camera "),t._UZ(8,"ion-icon",3),t.qZA()(),t.YNc(9,b,2,1,"ng-container",4),t.TgZ(10,"ion-modal",5),t.NdJ("willDismiss",function(d){return o.onWillDismiss(d)}),t.YNc(11,P,19,4,"ng-template"),t.qZA()(),t.TgZ(12,"ion-footer"),t._UZ(13,"ion-toolbar"),t.qZA()),2&e&&(t.xp6(9),t.Q6J("ngForOf",o.eventos))},dependencies:[u.sg,u.O5,l._Y,l.JJ,l.JL,l.Q7,s.YG,s.Sm,s.W2,s.IJ,s.W4,s.fr,s.Gu,s.gu,s.Ie,s.Q$,s.t9,s.n0,s.wd,s.sr,s.ki,s.QI,l.sg,l.u,u.uU],styles:['@import"https://192.168.36.36/360Linux/360/css/style.css";.error[_ngcontent-%COMP%]{font-size:small;color:red;padding-left:20px}.bg[_ngcontent-%COMP%], body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{font-family:Roboto!important;background:#373e46!important;color:#fff!important}']}),i})()}];let Z=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[g.Bz.forChild(U),g.Bz]}),i})(),T=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[u.ez,l.u5,s.Pc,l.UX,Z]}),i})()}}]);