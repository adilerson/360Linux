"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7561],{7561:(E,v,r)=>{r.r(v),r.d(v,{ConfigPageModule:()=>I});var u=r(9808),l=r(4182),s=r(5056),g=r(8808),c=r(655),p=r(9426),e=r(9863),f=r(1188),_=r(8819),C=r(6858);function x(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"ion-item",10),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(),d=n.$implicit,h=n.index,m=e.oxw();return e.KtG(m.eventoActionSheet(d,h))}),e.TgZ(2,"ion-label")(3,"h3"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.ALo(7,"date"),e.qZA()()()()}if(2&o){const t=e.oxw().$implicit;e.xp6(4),e.Oqu(t.nome),e.xp6(2),e.Oqu(e.xi3(7,2,t.data,"dd/MM/YYYY"))}}function Z(o,a){if(1&o&&(e.ynx(0),e.YNc(1,x,8,5,"div",9),e.BQk()),2&o){const t=a.$implicit;e.xp6(1),e.Q6J("ngIf","null"!==t.nome)}}function T(o,a){if(1&o&&(e.TgZ(0,"ion-select-option",16),e._uU(1),e.qZA()),2&o){const t=a.$implicit,i=a.index;e.Q6J("value",t),e.xp6(1),e.hij("",t.label?t.label:"Default Video "+i," ")}}function U(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",11)(3,"ion-button",1),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.cancel())}),e._uU(4,"Cancelar"),e.qZA()(),e.TgZ(5,"ion-title"),e._uU(6,"Evento"),e.qZA(),e.TgZ(7,"ion-buttons",0)(8,"ion-button",12),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.salvaEvento(n.configForm.value))}),e._uU(9,"Salvar"),e.qZA()()()(),e.TgZ(10,"ion-content",6)(11,"h1",6),e._uU(12,"Configura\xe7\xe3o da entrada de Video"),e.qZA(),e.TgZ(13,"form",13)(14,"ion-item")(15,"ion-label"),e._uU(16,"Entrada de Video"),e.qZA(),e.TgZ(17,"ion-select",14),e.YNc(18,T,2,2,"ion-select-option",15),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(8),e.Q6J("strong",!0)("disabled",!t.configForm.valid),e.xp6(5),e.Q6J("formGroup",t.configForm),e.xp6(5),e.Q6J("ngForOf",t.videoDevices)}}function b(o,a){if(1&o&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("Servidor: ",t.http.url,"")}}const y=[{path:"",component:(()=>{class o{constructor(t,i,n,d,h,m,A,D){this.storage=t,this.formBuilder=i,this.actionSheetCtrl=n,this.alertController=d,this.eventoService=h,this.toastController=m,this.router=A,this.http=D,this.message="This modal example uses triggers to automatically open a modal when the button is clicked.",this.isSubmitted=!1,this.eventos=[],this.apiUrl="",this.videoDevices=[]}ngOnInit(){this.configForm=this.formBuilder.group({videoInput:["",l.kI.required]}),this.videoInput=this.storage.get("videoInput")||"",this.apiUrl=this.storage.get("apiUrl")||"",console.log(this.apiUrl),console.log(this.http.url),this.apiUrl.length&&p.P.get("apiUrl").emit(this.apiUrl),this.getEventos()}ionViewDidEnter(){console.log(this.getDevices())}get errorControl(){return this.configForm.controls}getEventos(){return(0,c.mG)(this,void 0,void 0,function*(){(yield this.http.getEventos()).subscribe(t=>{console.log(t),this.eventos=[];for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&this.eventos.push(t[i]);console.log(this.eventos)})})}cancel(){this.modal.dismiss(null,"cancel")}confirm(){this.modal.dismiss(this.name,"confirm")}onWillDismiss(t){"confirm"===t.detail.role&&(this.message=`Hello, ${t.detail.data}!`)}salvaEvento(t){return(0,c.mG)(this,void 0,void 0,function*(){this.guardaEventos(t.videoInput),console.log(t),this.configForm.reset(),this.modal.dismiss()})}eventoActionSheet(t,i){return(0,c.mG)(this,void 0,void 0,function*(){console.log(t);const n=yield this.actionSheetCtrl.create({header:"Op\xe7\xf5es do Evento",mode:"ios",subHeader:t.nome,buttons:[{text:"Carregar Evento",handler:()=>{this.setConfig(t)}},{text:"Visualizar Evento",handler:()=>{this.seeEvento(t)}},{text:"Cancelar",role:"cancel",data:{action:"cancel"}}]});yield n.present();const d=yield n.onDidDismiss();this.result=JSON.stringify(d,null,2)})}deleteEvento(t){return(0,c.mG)(this,void 0,void 0,function*(){const i=yield this.alertController.create({header:"Deseja realmente Deletar o evento?",buttons:[{text:"Cancelar",role:"cancel",handler:()=>{}},{text:"Sim",role:"confirm",handler:()=>{this.eventos.splice(t,1)}}]});yield i.present(),yield i.onDidDismiss()})}guardaEventos(t){return(0,c.mG)(this,void 0,void 0,function*(){this.storage.set("videoInput",t),setTimeout(()=>{this.videoInput=this.storage.get("videoInput")||""},100)})}setConfig(t){return(0,c.mG)(this,void 0,void 0,function*(){if(!t.videoInput&&this.videoInput&&(t.videoInput=this.videoInput),!t.videoInput&&!this.videoInput)return yield(yield this.toastController.create({message:"Selecione a camera que ir\xe1 utilizar primeiro",duration:3e3,position:"bottom",color:"danger"})).present(),void this.modal.present();this.eventoService.setConfig(t),this.router.navigate(["/home"])})}seeEvento(t){return(0,c.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:`Nome:${t.nome},  Grava\xe7\xe3o: ${t.tempo} seg`,subHeader:`${t.frameName?"Frame: "+t.frameName:""} ${t.audioName?", Audio: "+t.audioName:""}  ${this.videoInput?", "+this.videoInput.label:", N\xe3o informada"}`,buttons:[{text:"Fechar",role:"cancel",handler:()=>{}}]})).present()})}configUrltAlert(){return(0,c.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:"Digite a url do servidor",subHeader:"ex: http://localhost:3000",buttons:["OK"],inputs:[{placeholder:"URL",value:`${this.apiUrl?this.apiUrl:""}`,handler:i=>{console.log(i)}}]});yield t.present(),t.onWillDismiss().then(i=>{var n;null!==(n=i.data)&&void 0!==n&&n.values[0]&&(this.apiUrl=i.data.values[0],this.storage.set("apiUrl",i.data.values[0]),p.P.get("apiUrl").emit(i.data.values[0]))})})}getDevices(){this.videoDevices=[],navigator.mediaDevices.getUserMedia({video:{width:{ideal:1080},height:{ideal:720}}}).then(t=>{navigator.mediaDevices.enumerateDevices().then(i=>{i.forEach(n=>{console.log(n),"videoinput"===n.kind&&n.deviceId&&this.videoDevices.push(n)})}),setTimeout(()=>{t.getTracks().forEach(i=>{i.stop()})},200)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(f.V),e.Y36(l.qu),e.Y36(s.BX),e.Y36(s.Br),e.Y36(_.k),e.Y36(s.yF),e.Y36(g.F0),e.Y36(C.O))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-config"]],viewQuery:function(t,i){if(1&t&&(e.Gf(s.ki,5),e.Gf(s.x4,5)),2&t){let n;e.iGM(n=e.CRH())&&(i.modal=n.first),e.iGM(n=e.CRH())&&(i.dateTime=n.first)}},decls:19,vars:2,consts:[["slot","end"],[3,"click"],["name","options-sharp"],["slot","fixed","vertical","bottom","horizontal","end"],["id","open-modal"],["name","cog"],[1,"ion-padding"],[4,"ngFor","ngForOf"],["trigger","open-modal",3,"willDismiss"],[4,"ngIf"],["button","",3,"click"],["slot","start"],[3,"strong","disabled","click"],[3,"formGroup"],["placeholder","Video","id","Video","formControlName","videoInput","required",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Evento "),e.qZA(),e.TgZ(4,"ion-buttons",0)(5,"ion-button",1),e.NdJ("click",function(){return i.configUrltAlert()}),e._UZ(6,"ion-icon",2),e.qZA()()()(),e.TgZ(7,"ion-content")(8,"ion-fab",3)(9,"ion-fab-button",4),e._UZ(10,"ion-icon",5),e.qZA()(),e.TgZ(11,"h1",6),e._uU(12,"Eventos Cadastrados"),e.qZA(),e.YNc(13,Z,2,1,"ng-container",7),e.TgZ(14,"ion-modal",8),e.NdJ("willDismiss",function(d){return i.onWillDismiss(d)}),e.YNc(15,U,19,4,"ng-template"),e.qZA()(),e.TgZ(16,"ion-footer")(17,"ion-toolbar"),e.YNc(18,b,2,1,"p",9),e.qZA()()),2&t&&(e.xp6(13),e.Q6J("ngForOf",i.eventos),e.xp6(5),e.Q6J("ngIf",i.http.url))},dependencies:[u.sg,u.O5,l._Y,l.JJ,l.JL,l.Q7,s.YG,s.Sm,s.W2,s.IJ,s.W4,s.fr,s.Gu,s.gu,s.Ie,s.Q$,s.t9,s.n0,s.wd,s.sr,s.ki,s.QI,l.sg,l.u,u.uU],styles:[".error[_ngcontent-%COMP%]{font-size:small;color:red;padding-left:20px}"]}),o})()}];let P=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[g.Bz.forChild(y),g.Bz]}),o})(),I=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[u.ez,l.u5,s.Pc,l.UX,P]}),o})()}}]);