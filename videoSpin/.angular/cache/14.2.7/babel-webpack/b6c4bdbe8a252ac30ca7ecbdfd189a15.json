{"ast":null,"code":"import _asyncToGenerator from \"E:/IONIC/360Linux/videoSpin/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport Hls from 'hls.js';\nexport class VideoPlayer {\n  constructor(mode, url, playerId, rate, exitOnEnd, loopOnEnd, container, zIndex, width, height) {\n    this.pipMode = false;\n    this._videoType = null;\n    this._videoContainer = null;\n    this._firstReadyToPlay = true;\n    this._isEnded = false;\n    this._videoRate = 1.0;\n    this._videoExitOnEnd = true;\n    this._videoLoopOnEnd = false;\n    this._url = url;\n    this._container = container;\n    this._mode = mode;\n    this._width = width ? width : 320;\n    this._height = height ? height : 180;\n    this._mode = mode;\n    this._videoRate = rate;\n    this._zIndex = zIndex ? zIndex : 1;\n    this._playerId = playerId;\n    this._videoExitOnEnd = exitOnEnd;\n    this._videoLoopOnEnd = loopOnEnd;\n  }\n\n  initialize() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      // get the video type\n      const retB = _this._getVideoType();\n\n      if (retB) {\n        // style the container\n        if (_this._mode === 'fullscreen') {\n          _this._container.style.position = 'absolute';\n          _this._container.style.width = '100vw';\n          _this._container.style.height = '100vh';\n        }\n\n        if (_this._mode === 'embedded') {\n          _this._container.style.position = 'relative';\n          _this._container.style.width = _this._width.toString() + 'px';\n          _this._container.style.height = _this._height.toString() + 'px';\n        }\n\n        _this._container.style.left = '0';\n        _this._container.style.top = '0';\n        _this._container.style.display = 'flex';\n        _this._container.style.alignItems = 'center';\n        _this._container.style.justifyContent = 'center';\n        _this._container.style.backgroundColor = '#000000';\n        _this._container.style.zIndex = _this._zIndex.toString();\n        const width = _this._mode === 'fullscreen' ? window.innerWidth\n        /*this._container.offsetWidth*/\n        : _this._width;\n        const height = _this._mode === 'fullscreen' ? window.innerHeight\n        /*this._container.offsetHeight*/\n        : _this._height;\n        const xmlns = 'http://www.w3.org/2000/svg';\n        const svg = document.createElementNS(xmlns, 'svg');\n        svg.setAttributeNS(null, 'width', width.toString());\n        svg.setAttributeNS(null, 'height', height.toString());\n        const viewbox = '0 0 ' + width.toString() + ' ' + height.toString();\n        svg.setAttributeNS(null, 'viewBox', viewbox);\n        svg.style.zIndex = (_this._zIndex + 1).toString();\n        const rect = document.createElementNS(xmlns, 'rect');\n        rect.setAttributeNS(null, 'x', '0');\n        rect.setAttributeNS(null, 'y', '0');\n        rect.setAttributeNS(null, 'width', width.toString());\n        rect.setAttributeNS(null, 'height', height.toString());\n        rect.setAttributeNS(null, 'fill', '#000000');\n        svg.appendChild(rect);\n\n        _this._container.appendChild(svg);\n\n        const heightVideo = width * _this._height / _this._width;\n        _this._videoContainer = document.createElement('div');\n        _this._videoContainer.style.position = 'absolute';\n        _this._videoContainer.style.left = '0';\n        _this._videoContainer.style.width = width.toString() + 'px';\n        _this._videoContainer.style.height = heightVideo.toString() + 'px';\n        _this._videoContainer.style.zIndex = (_this._zIndex + 2).toString();\n\n        _this._container.appendChild(_this._videoContainer);\n        /*   Create Video Element */\n\n\n        const isCreated = yield _this.createVideoElement(width, heightVideo);\n\n        if (!isCreated) {\n          _this._createEvent('Exit', _this._playerId, 'Video Error: failed to create the Video Element');\n        }\n      } else {\n        _this._createEvent('Exit', _this._playerId, 'Url Error: type not supported');\n      }\n\n      return;\n    })();\n  }\n\n  createVideoElement(width, height) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      _this2.videoEl = document.createElement('video');\n      _this2.videoEl.controls = true;\n      _this2.videoEl.style.zIndex = (_this2._zIndex + 3).toString();\n      _this2.videoEl.style.width = `${width.toString()}px`;\n      _this2.videoEl.style.height = `${height.toString()}px`;\n      _this2.videoEl.playbackRate = _this2._videoRate;\n\n      _this2._videoContainer.appendChild(_this2.videoEl); // set the player\n\n\n      const isSet = yield _this2._setPlayer();\n\n      if (isSet) {\n        _this2.videoEl.onended = /*#__PURE__*/_asyncToGenerator(function* () {\n          _this2._isEnded = true;\n          _this2.isPlaying = false;\n\n          if (_this2.videoEl) {\n            _this2.videoEl.currentTime = 0;\n          }\n\n          if (_this2._videoExitOnEnd) {\n            if (_this2._mode === 'fullscreen') {\n              _this2._closeFullscreen();\n            }\n\n            _this2._createEvent('Ended', _this2._playerId);\n          } else {\n            if (_this2._videoLoopOnEnd && _this2.videoEl != null) {\n              yield _this2.videoEl.play();\n            }\n          }\n        });\n        _this2.videoEl.oncanplay = /*#__PURE__*/_asyncToGenerator(function* () {\n          if (_this2._firstReadyToPlay) {\n            _this2._createEvent('Ready', _this2._playerId);\n\n            if (_this2.videoEl != null) {\n              _this2.videoEl.muted = false;\n              if (_this2._mode === 'fullscreen') yield _this2.videoEl.play();\n              _this2._firstReadyToPlay = false;\n            }\n          }\n        });\n\n        _this2.videoEl.onplay = () => {\n          _this2.isPlaying = true;\n          if (_this2._firstReadyToPlay) _this2._firstReadyToPlay = false;\n\n          _this2._createEvent('Play', _this2._playerId);\n        };\n\n        _this2.videoEl.onplaying = () => {\n          _this2._createEvent('Playing', _this2._playerId);\n        };\n\n        _this2.videoEl.onpause = () => {\n          _this2.isPlaying = false;\n\n          _this2._createEvent('Pause', _this2._playerId);\n        };\n\n        if (_this2._mode === 'fullscreen') {\n          // create the video player exit button\n          const exitEl = document.createElement('button');\n          exitEl.textContent = 'X';\n          exitEl.style.position = 'absolute';\n          exitEl.style.left = '1%';\n          exitEl.style.top = '5%';\n          exitEl.style.width = '5vmin';\n          exitEl.style.padding = '0.5%';\n          exitEl.style.fontSize = '1.2rem';\n          exitEl.style.background = 'rgba(51,51,51,.4)';\n          exitEl.style.color = '#fff';\n          exitEl.style.visibility = 'hidden';\n          exitEl.style.zIndex = (_this2._zIndex + 4).toString();\n          exitEl.style.border = '1px solid rgba(51,51,51,.4)';\n          exitEl.style.borderRadius = '20px';\n          _this2._videoContainer.onclick = /*#__PURE__*/_asyncToGenerator(function* () {\n            _this2._initial = yield _this2._doHide(exitEl, 3000);\n          });\n          _this2._videoContainer.ontouchstart = /*#__PURE__*/_asyncToGenerator(function* () {\n            _this2._initial = yield _this2._doHide(exitEl, 3000);\n          });\n          _this2._videoContainer.onmousemove = /*#__PURE__*/_asyncToGenerator(function* () {\n            _this2._initial = yield _this2._doHide(exitEl, 3000);\n          });\n\n          exitEl.onclick = () => {\n            _this2._createEvent('Exit', _this2._playerId);\n          };\n\n          exitEl.ontouchstart = () => {\n            _this2._createEvent('Exit', _this2._playerId);\n          };\n\n          _this2._videoContainer.appendChild(exitEl);\n\n          _this2._initial = yield _this2._doHide(exitEl, 3000);\n\n          _this2._goFullscreen();\n        }\n      }\n\n      return isSet;\n    })();\n  }\n\n  _goFullscreen() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this3._container.mozRequestFullScreen) {\n        /* Firefox */\n        _this3._container.mozRequestFullScreen();\n      } else if (_this3._container.webkitRequestFullscreen) {\n        /* Chrome, Safari & Opera */\n        _this3._container.webkitRequestFullscreen();\n      } else if (_this3._container.msRequestFullscreen) {\n        /* IE/Edge */\n        _this3._container.msRequestFullscreen();\n      } else if (_this3._container.requestFullscreen) {\n        _this3._container.requestFullscreen();\n      }\n\n      return;\n    })();\n  }\n\n  _setPlayer() {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise(resolve => {\n        if (_this4.videoEl != null) {\n          if (Hls.isSupported() && _this4._videoType === 'application/x-mpegURL') {\n            const hls = new Hls();\n            hls.loadSource(_this4._url);\n            hls.attachMedia(_this4.videoEl);\n            hls.on(Hls.Events.MANIFEST_PARSED, () => {\n              if (_this4.videoEl != null) {\n                _this4.videoEl.muted = true;\n                _this4.videoEl.crossOrigin = 'anonymous';\n                resolve(true);\n              } else {\n                resolve(false);\n              }\n            });\n          } else if (_this4._videoType === 'video/mp4') {\n            // CMAF (fMP4) && MP4\n            _this4.videoEl.src = _this4._url;\n            if (_this4._url.substring(0, 5) != 'https' && _this4._url.substring(0, 4) === 'http') _this4.videoEl.crossOrigin = 'anonymous';\n            if (_this4._url.substring(0, 5) === 'https' || _this4._url.substring(0, 4) === 'http') _this4.videoEl.muted = true;\n            resolve(true);\n          } else {\n            // Not Supported\n            resolve(false);\n          }\n\n          _this4.videoEl.addEventListener('enterpictureinpicture', event => {\n            _this4.pipWindow = event.pictureInPictureWindow;\n            console.log(' Enter PiP Mode ', _this4.pipWindow);\n            _this4.pipMode = true;\n\n            _this4._closeFullscreen();\n          });\n\n          _this4.videoEl.addEventListener('leavepictureinpicture', () => {\n            console.log(' Exit PiP Mode ');\n            _this4.pipMode = false;\n\n            if (!_this4._isEnded) {\n              _this4._goFullscreen();\n\n              if (_this4.videoEl != null) _this4.videoEl.play();\n            }\n          });\n        } else {\n          resolve(false);\n        }\n      });\n    })();\n  }\n\n  _getVideoType() {\n    let ret = false;\n    let vType = '';\n    const sUrl = this._url ? this._url : '';\n\n    if (sUrl != null && sUrl.length > 0) {\n      try {\n        const val = sUrl.substring(sUrl.lastIndexOf('/')).match(/(.*)\\.(.*)/);\n\n        if (val == null) {\n          vType = '';\n        } else {\n          const a = sUrl.match(/(.*)\\.(.*)/);\n          vType = a != null ? a[2].split('?')[0] : '';\n        }\n\n        switch (vType) {\n          case 'mp4':\n          case '':\n          case 'webm':\n          case 'cmaf':\n          case 'cmfv':\n          case 'cmfa':\n            {\n              this._videoType = 'video/mp4';\n              break;\n            }\n\n          case 'm3u8':\n            {\n              this._videoType = 'application/x-mpegURL';\n              break;\n            }\n\n          /*\n                  case \"mpd\" : {\n                  this._videoType = \"application/dash+xml\";\n                  break;\n                  }\n          */\n\n          /*\n                  case \"youtube\" : {\n                  this._videoType = \"video/youtube\";\n                  break;\n                  }\n          */\n\n          default:\n            {\n              this._videoType = null;\n              break;\n            }\n        }\n\n        ret = true;\n      } catch (_a) {\n        ret = false;\n      }\n    }\n\n    return ret;\n  }\n\n  _doHide(exitEl, duration) {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      clearTimeout(_this5._initial);\n      exitEl.style.visibility = 'visible';\n      const initial = setTimeout(() => {\n        exitEl.style.visibility = 'hidden';\n      }, duration);\n      return initial;\n    })();\n  }\n\n  _createEvent(ev, playerId, msg) {\n    const message = msg ? msg : null;\n    let event;\n\n    if (message != null) {\n      event = new CustomEvent(`videoPlayer${ev}`, {\n        detail: {\n          fromPlayerId: playerId,\n          message: message\n        }\n      });\n    } else {\n      const currentTime = this.videoEl ? this.videoEl.currentTime : 0;\n      event = new CustomEvent(`videoPlayer${ev}`, {\n        detail: {\n          fromPlayerId: playerId,\n          currentTime: currentTime\n        }\n      });\n    }\n\n    this._container.dispatchEvent(event);\n  }\n\n  _closeFullscreen() {\n    const mydoc = document;\n    const isInFullScreen = mydoc.fullscreenElement && mydoc.fullscreenElement !== null || mydoc.webkitFullscreenElement && mydoc.webkitFullscreenElement !== null || mydoc.mozFullScreenElement && mydoc.mozFullScreenElement !== null || mydoc.msFullscreenElement && mydoc.msFullscreenElement !== null;\n\n    if (isInFullScreen) {\n      if (mydoc.mozCancelFullScreen) {\n        mydoc.mozCancelFullScreen();\n      } else if (mydoc.webkitExitFullscreen) {\n        mydoc.webkitExitFullscreen();\n      } else if (mydoc.msExitFullscreen) {\n        mydoc.msExitFullscreen();\n      } else if (mydoc.exitFullscreen) {\n        mydoc.exitFullscreen();\n      }\n    }\n  }\n\n}","map":{"version":3,"names":["Hls","VideoPlayer","constructor","mode","url","playerId","rate","exitOnEnd","loopOnEnd","container","zIndex","width","height","pipMode","_videoType","_videoContainer","_firstReadyToPlay","_isEnded","_videoRate","_videoExitOnEnd","_videoLoopOnEnd","_url","_container","_mode","_width","_height","_zIndex","_playerId","initialize","retB","_getVideoType","style","position","toString","left","top","display","alignItems","justifyContent","backgroundColor","window","innerWidth","innerHeight","xmlns","svg","document","createElementNS","setAttributeNS","viewbox","rect","appendChild","heightVideo","createElement","isCreated","createVideoElement","_createEvent","videoEl","controls","playbackRate","isSet","_setPlayer","onended","isPlaying","currentTime","_closeFullscreen","play","oncanplay","muted","onplay","onplaying","onpause","exitEl","textContent","padding","fontSize","background","color","visibility","border","borderRadius","onclick","_initial","_doHide","ontouchstart","onmousemove","_goFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","requestFullscreen","Promise","resolve","isSupported","hls","loadSource","attachMedia","on","Events","MANIFEST_PARSED","crossOrigin","src","substring","addEventListener","event","pipWindow","pictureInPictureWindow","console","log","ret","vType","sUrl","length","val","lastIndexOf","match","a","split","_a","duration","clearTimeout","initial","setTimeout","ev","msg","message","CustomEvent","detail","fromPlayerId","dispatchEvent","mydoc","isInFullScreen","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","mozCancelFullScreen","webkitExitFullscreen","msExitFullscreen","exitFullscreen"],"sources":["E:/IONIC/360Linux/videoSpin/node_modules/capacitor-video-player/dist/esm/web-utils/videoplayer.js"],"sourcesContent":["import Hls from 'hls.js';\nexport class VideoPlayer {\n    constructor(mode, url, playerId, rate, exitOnEnd, loopOnEnd, container, zIndex, width, height) {\n        this.pipMode = false;\n        this._videoType = null;\n        this._videoContainer = null;\n        this._firstReadyToPlay = true;\n        this._isEnded = false;\n        this._videoRate = 1.0;\n        this._videoExitOnEnd = true;\n        this._videoLoopOnEnd = false;\n        this._url = url;\n        this._container = container;\n        this._mode = mode;\n        this._width = width ? width : 320;\n        this._height = height ? height : 180;\n        this._mode = mode;\n        this._videoRate = rate;\n        this._zIndex = zIndex ? zIndex : 1;\n        this._playerId = playerId;\n        this._videoExitOnEnd = exitOnEnd;\n        this._videoLoopOnEnd = loopOnEnd;\n    }\n    async initialize() {\n        // get the video type\n        const retB = this._getVideoType();\n        if (retB) {\n            // style the container\n            if (this._mode === 'fullscreen') {\n                this._container.style.position = 'absolute';\n                this._container.style.width = '100vw';\n                this._container.style.height = '100vh';\n            }\n            if (this._mode === 'embedded') {\n                this._container.style.position = 'relative';\n                this._container.style.width = this._width.toString() + 'px';\n                this._container.style.height = this._height.toString() + 'px';\n            }\n            this._container.style.left = '0';\n            this._container.style.top = '0';\n            this._container.style.display = 'flex';\n            this._container.style.alignItems = 'center';\n            this._container.style.justifyContent = 'center';\n            this._container.style.backgroundColor = '#000000';\n            this._container.style.zIndex = this._zIndex.toString();\n            const width = this._mode === 'fullscreen'\n                ? window.innerWidth /*this._container.offsetWidth*/\n                : this._width;\n            const height = this._mode === 'fullscreen'\n                ? window.innerHeight /*this._container.offsetHeight*/\n                : this._height;\n            const xmlns = 'http://www.w3.org/2000/svg';\n            const svg = document.createElementNS(xmlns, 'svg');\n            svg.setAttributeNS(null, 'width', width.toString());\n            svg.setAttributeNS(null, 'height', height.toString());\n            const viewbox = '0 0 ' + width.toString() + ' ' + height.toString();\n            svg.setAttributeNS(null, 'viewBox', viewbox);\n            svg.style.zIndex = (this._zIndex + 1).toString();\n            const rect = document.createElementNS(xmlns, 'rect');\n            rect.setAttributeNS(null, 'x', '0');\n            rect.setAttributeNS(null, 'y', '0');\n            rect.setAttributeNS(null, 'width', width.toString());\n            rect.setAttributeNS(null, 'height', height.toString());\n            rect.setAttributeNS(null, 'fill', '#000000');\n            svg.appendChild(rect);\n            this._container.appendChild(svg);\n            const heightVideo = (width * this._height) / this._width;\n            this._videoContainer = document.createElement('div');\n            this._videoContainer.style.position = 'absolute';\n            this._videoContainer.style.left = '0';\n            this._videoContainer.style.width = width.toString() + 'px';\n            this._videoContainer.style.height = heightVideo.toString() + 'px';\n            this._videoContainer.style.zIndex = (this._zIndex + 2).toString();\n            this._container.appendChild(this._videoContainer);\n            /*   Create Video Element */\n            const isCreated = await this.createVideoElement(width, heightVideo);\n            if (!isCreated) {\n                this._createEvent('Exit', this._playerId, 'Video Error: failed to create the Video Element');\n            }\n        }\n        else {\n            this._createEvent('Exit', this._playerId, 'Url Error: type not supported');\n        }\n        return;\n    }\n    async createVideoElement(width, height) {\n        this.videoEl = document.createElement('video');\n        this.videoEl.controls = true;\n        this.videoEl.style.zIndex = (this._zIndex + 3).toString();\n        this.videoEl.style.width = `${width.toString()}px`;\n        this.videoEl.style.height = `${height.toString()}px`;\n        this.videoEl.playbackRate = this._videoRate;\n        this._videoContainer.appendChild(this.videoEl);\n        // set the player\n        const isSet = await this._setPlayer();\n        if (isSet) {\n            this.videoEl.onended = async () => {\n                this._isEnded = true;\n                this.isPlaying = false;\n                if (this.videoEl) {\n                    this.videoEl.currentTime = 0;\n                }\n                if (this._videoExitOnEnd) {\n                    if (this._mode === 'fullscreen') {\n                        this._closeFullscreen();\n                    }\n                    this._createEvent('Ended', this._playerId);\n                }\n                else {\n                    if (this._videoLoopOnEnd && this.videoEl != null) {\n                        await this.videoEl.play();\n                    }\n                }\n            };\n            this.videoEl.oncanplay = async () => {\n                if (this._firstReadyToPlay) {\n                    this._createEvent('Ready', this._playerId);\n                    if (this.videoEl != null) {\n                        this.videoEl.muted = false;\n                        if (this._mode === 'fullscreen')\n                            await this.videoEl.play();\n                        this._firstReadyToPlay = false;\n                    }\n                }\n            };\n            this.videoEl.onplay = () => {\n                this.isPlaying = true;\n                if (this._firstReadyToPlay)\n                    this._firstReadyToPlay = false;\n                this._createEvent('Play', this._playerId);\n            };\n            this.videoEl.onplaying = () => {\n                this._createEvent('Playing', this._playerId);\n            };\n            this.videoEl.onpause = () => {\n                this.isPlaying = false;\n                this._createEvent('Pause', this._playerId);\n            };\n            if (this._mode === 'fullscreen') {\n                // create the video player exit button\n                const exitEl = document.createElement('button');\n                exitEl.textContent = 'X';\n                exitEl.style.position = 'absolute';\n                exitEl.style.left = '1%';\n                exitEl.style.top = '5%';\n                exitEl.style.width = '5vmin';\n                exitEl.style.padding = '0.5%';\n                exitEl.style.fontSize = '1.2rem';\n                exitEl.style.background = 'rgba(51,51,51,.4)';\n                exitEl.style.color = '#fff';\n                exitEl.style.visibility = 'hidden';\n                exitEl.style.zIndex = (this._zIndex + 4).toString();\n                exitEl.style.border = '1px solid rgba(51,51,51,.4)';\n                exitEl.style.borderRadius = '20px';\n                this._videoContainer.onclick = async () => {\n                    this._initial = await this._doHide(exitEl, 3000);\n                };\n                this._videoContainer.ontouchstart = async () => {\n                    this._initial = await this._doHide(exitEl, 3000);\n                };\n                this._videoContainer.onmousemove = async () => {\n                    this._initial = await this._doHide(exitEl, 3000);\n                };\n                exitEl.onclick = () => {\n                    this._createEvent('Exit', this._playerId);\n                };\n                exitEl.ontouchstart = () => {\n                    this._createEvent('Exit', this._playerId);\n                };\n                this._videoContainer.appendChild(exitEl);\n                this._initial = await this._doHide(exitEl, 3000);\n                this._goFullscreen();\n            }\n        }\n        return isSet;\n    }\n    async _goFullscreen() {\n        if (this._container.mozRequestFullScreen) {\n            /* Firefox */\n            this._container.mozRequestFullScreen();\n        }\n        else if (this._container.webkitRequestFullscreen) {\n            /* Chrome, Safari & Opera */\n            this._container.webkitRequestFullscreen();\n        }\n        else if (this._container.msRequestFullscreen) {\n            /* IE/Edge */\n            this._container.msRequestFullscreen();\n        }\n        else if (this._container.requestFullscreen) {\n            this._container.requestFullscreen();\n        }\n        return;\n    }\n    async _setPlayer() {\n        return new Promise(resolve => {\n            if (this.videoEl != null) {\n                if (Hls.isSupported() && this._videoType === 'application/x-mpegURL') {\n                    const hls = new Hls();\n                    hls.loadSource(this._url);\n                    hls.attachMedia(this.videoEl);\n                    hls.on(Hls.Events.MANIFEST_PARSED, () => {\n                        if (this.videoEl != null) {\n                            this.videoEl.muted = true;\n                            this.videoEl.crossOrigin = 'anonymous';\n                            resolve(true);\n                        }\n                        else {\n                            resolve(false);\n                        }\n                    });\n                }\n                else if (this._videoType === 'video/mp4') {\n                    // CMAF (fMP4) && MP4\n                    this.videoEl.src = this._url;\n                    if (this._url.substring(0, 5) != 'https' &&\n                        this._url.substring(0, 4) === 'http')\n                        this.videoEl.crossOrigin = 'anonymous';\n                    if (this._url.substring(0, 5) === 'https' ||\n                        this._url.substring(0, 4) === 'http')\n                        this.videoEl.muted = true;\n                    resolve(true);\n                }\n                else {\n                    // Not Supported\n                    resolve(false);\n                }\n                this.videoEl.addEventListener('enterpictureinpicture', (event) => {\n                    this.pipWindow = event.pictureInPictureWindow;\n                    console.log(' Enter PiP Mode ', this.pipWindow);\n                    this.pipMode = true;\n                    this._closeFullscreen();\n                });\n                this.videoEl.addEventListener('leavepictureinpicture', () => {\n                    console.log(' Exit PiP Mode ');\n                    this.pipMode = false;\n                    if (!this._isEnded) {\n                        this._goFullscreen();\n                        if (this.videoEl != null)\n                            this.videoEl.play();\n                    }\n                });\n            }\n            else {\n                resolve(false);\n            }\n        });\n    }\n    _getVideoType() {\n        let ret = false;\n        let vType = '';\n        const sUrl = this._url ? this._url : '';\n        if (sUrl != null && sUrl.length > 0) {\n            try {\n                const val = sUrl.substring(sUrl.lastIndexOf('/')).match(/(.*)\\.(.*)/);\n                if (val == null) {\n                    vType = '';\n                }\n                else {\n                    const a = sUrl.match(/(.*)\\.(.*)/);\n                    vType = a != null ? a[2].split('?')[0] : '';\n                }\n                switch (vType) {\n                    case 'mp4':\n                    case '':\n                    case 'webm':\n                    case 'cmaf':\n                    case 'cmfv':\n                    case 'cmfa': {\n                        this._videoType = 'video/mp4';\n                        break;\n                    }\n                    case 'm3u8': {\n                        this._videoType = 'application/x-mpegURL';\n                        break;\n                    }\n                    /*\n                            case \"mpd\" : {\n                            this._videoType = \"application/dash+xml\";\n                            break;\n                            }\n                    */\n                    /*\n                            case \"youtube\" : {\n                            this._videoType = \"video/youtube\";\n                            break;\n                            }\n                    */\n                    default: {\n                        this._videoType = null;\n                        break;\n                    }\n                }\n                ret = true;\n            }\n            catch (_a) {\n                ret = false;\n            }\n        }\n        return ret;\n    }\n    async _doHide(exitEl, duration) {\n        clearTimeout(this._initial);\n        exitEl.style.visibility = 'visible';\n        const initial = setTimeout(() => {\n            exitEl.style.visibility = 'hidden';\n        }, duration);\n        return initial;\n    }\n    _createEvent(ev, playerId, msg) {\n        const message = msg ? msg : null;\n        let event;\n        if (message != null) {\n            event = new CustomEvent(`videoPlayer${ev}`, {\n                detail: { fromPlayerId: playerId, message: message },\n            });\n        }\n        else {\n            const currentTime = this.videoEl ? this.videoEl.currentTime : 0;\n            event = new CustomEvent(`videoPlayer${ev}`, {\n                detail: { fromPlayerId: playerId, currentTime: currentTime },\n            });\n        }\n        this._container.dispatchEvent(event);\n    }\n    _closeFullscreen() {\n        const mydoc = document;\n        const isInFullScreen = (mydoc.fullscreenElement && mydoc.fullscreenElement !== null) ||\n            (mydoc.webkitFullscreenElement &&\n                mydoc.webkitFullscreenElement !== null) ||\n            (mydoc.mozFullScreenElement && mydoc.mozFullScreenElement !== null) ||\n            (mydoc.msFullscreenElement && mydoc.msFullscreenElement !== null);\n        if (isInFullScreen) {\n            if (mydoc.mozCancelFullScreen) {\n                mydoc.mozCancelFullScreen();\n            }\n            else if (mydoc.webkitExitFullscreen) {\n                mydoc.webkitExitFullscreen();\n            }\n            else if (mydoc.msExitFullscreen) {\n                mydoc.msExitFullscreen();\n            }\n            else if (mydoc.exitFullscreen) {\n                mydoc.exitFullscreen();\n            }\n        }\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}